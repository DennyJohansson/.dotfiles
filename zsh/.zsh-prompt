autoload -U colors && colors
setopt prompt_subst
bindkey -v

git_branch() {
  local b
  b=$(git symbolic-ref --short -q HEAD 2>/dev/null) \
    || b=$(git rev-parse --short HEAD 2>/dev/null) || return
  printf ' [%s]' "$b"
}

# too see all colors in terminal
# for i in {0..255}; do
#   print -Pn "%K{$i} %F{15}${(l:3::0:)i}%f%k "
#   (( (i+1) % 16 )) || print
# done

update_mode() {
  case $KEYMAP in
    vicmd) VIM_MODE='%F{38}[N]%f' ;;
    viins|main) VIM_MODE='%F{35}[I]%f' ;;
    *) VIM_MODE='' ;;
  esac
}

zle-keymap-select() { update_mode; zle reset-prompt }
zle -N zle-keymap-select
zle-line-init() { zle -K viins; update_mode; zle reset-prompt }
zle -N zle-line-init

PROMPT='%F{blue}%~%f%F{yellow}$(git_branch)%f ${VIM_MODE}%F{green} ‚ùØ%f '
# RPROMPT='${VI_MODE}'
